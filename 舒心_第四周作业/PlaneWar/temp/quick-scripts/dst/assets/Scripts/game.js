
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Scripts/game.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '31c48bPWn9ERZwAfQRNIDjj', 'game');
// Scripts/game.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    bullet_1Prefab: {
      "default": null,
      type: cc.Prefab
    },
    player: {
      "default": null,
      type: cc.Node
    },
    enemyPrefab: {
      "default": null,
      type: cc.Prefab
    },
    enemyBulletPrefab: {
      "default": null,
      type: cc.Prefab
    },
    score: {
      "default": null,
      type: cc.Label
    },
    scoreAudio: {
      "default": null,
      type: cc.AudioClip
    },
    bullet_2Prefab: {
      "default": null,
      type: cc.Prefab
    },
    boomPrefab: {
      "default": null,
      type: cc.Prefab
    },
    enemyBuffPrefab: {
      "default": null,
      type: cc.Prefab
    },
    buff: {
      "default": null,
      type: cc.Prefab
    }
  },
  onLoad: function onLoad() {
    this.tran = 0;
    this.Score = 0;
    this.bulletrDuration = 2;
    this.timer = 0;
    this.player.getComponent('player').game = this;
  },
  start: function start() {},
  update: function update(dt) {
    //enemy plane
    if (this.timer > this.bulletrDuration) {
      this.spawnNewEnemy();
      this.timer = 0;
      return;
    }

    this.timer += dt;
  },
  //bullet
  spawnNewBullet: function spawnNewBullet(X, Y) {
    switch (this.tran) {
      case 0:
        var newBullet = cc.instantiate(this.bullet_1Prefab);
        this.node.addChild(newBullet);
        newBullet.setPosition(cc.v2(X, Y));
        break;

      case 1:
        var newBullet = cc.instantiate(this.bullet_2Prefab);
        this.node.addChild(newBullet);
        newBullet.setPosition(cc.v2(X, Y));
        break;
    }
  },
  //enemy plane random location
  spawnNewEnemy: function spawnNewEnemy() {
    if (Math.random() < 0.3) {
      var newEnemy = cc.instantiate(this.enemyBuffPrefab);
      this.node.addChild(newEnemy);
      newEnemy.setPosition(this.getNewEnemyPosition());
    } else {
      var newEnemy = cc.instantiate(this.enemyPrefab);
      this.node.addChild(newEnemy);
      newEnemy.setPosition(this.getNewEnemyPosition());
    }
  },
  getNewEnemyPosition: function getNewEnemyPosition() {
    var randX = 0; //  get the x coordiate through screen width

    var maxX = this.node.width / 2;
    randX = (Math.random() - 0.5) * 2 * maxX;
    return cc.v2(randX, 480);
  },
  //enemy plane's bullet
  spawnEnemyBullet: function spawnEnemyBullet(X, Y) {
    var newEnemyBullet = cc.instantiate(this.enemyBulletPrefab);
    this.node.addChild(newEnemyBullet);
    newEnemyBullet.setPosition(cc.v2(X, Y));
  },
  //score
  addScore: function addScore() {
    cc.audioEngine.playEffect(this.scoreAudio, false);
    this.Score++;
    this.score.string = "Scoer: " + this.Score;
  },
  //boom
  addBoom: function addBoom(X, Y) {
    var newBoom = cc.instantiate(this.boomPrefab);
    this.node.addChild(newBoom);
    newBoom.setPosition(cc.v2(X, Y));
  },
  //buff
  addBuff: function addBuff(X, Y) {
    var newBuff = cc.instantiate(this.buff);
    this.node.addChild(newBuff);
    newBuff.setPosition(cc.v2(X, Y));
  },
  tran_Bullet: function tran_Bullet(X) {
    this.tran = X;
  },
  gameOver: function gameOver() {
    cc.director.loadScene('end');
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0c1xcZ2FtZS5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImJ1bGxldF8xUHJlZmFiIiwidHlwZSIsIlByZWZhYiIsInBsYXllciIsIk5vZGUiLCJlbmVteVByZWZhYiIsImVuZW15QnVsbGV0UHJlZmFiIiwic2NvcmUiLCJMYWJlbCIsInNjb3JlQXVkaW8iLCJBdWRpb0NsaXAiLCJidWxsZXRfMlByZWZhYiIsImJvb21QcmVmYWIiLCJlbmVteUJ1ZmZQcmVmYWIiLCJidWZmIiwib25Mb2FkIiwidHJhbiIsIlNjb3JlIiwiYnVsbGV0ckR1cmF0aW9uIiwidGltZXIiLCJnZXRDb21wb25lbnQiLCJnYW1lIiwic3RhcnQiLCJ1cGRhdGUiLCJkdCIsInNwYXduTmV3RW5lbXkiLCJzcGF3bk5ld0J1bGxldCIsIlgiLCJZIiwibmV3QnVsbGV0IiwiaW5zdGFudGlhdGUiLCJub2RlIiwiYWRkQ2hpbGQiLCJzZXRQb3NpdGlvbiIsInYyIiwiTWF0aCIsInJhbmRvbSIsIm5ld0VuZW15IiwiZ2V0TmV3RW5lbXlQb3NpdGlvbiIsInJhbmRYIiwibWF4WCIsIndpZHRoIiwic3Bhd25FbmVteUJ1bGxldCIsIm5ld0VuZW15QnVsbGV0IiwiYWRkU2NvcmUiLCJhdWRpb0VuZ2luZSIsInBsYXlFZmZlY3QiLCJzdHJpbmciLCJhZGRCb29tIiwibmV3Qm9vbSIsImFkZEJ1ZmYiLCJuZXdCdWZmIiwidHJhbl9CdWxsZXQiLCJnYW1lT3ZlciIsImRpcmVjdG9yIiwibG9hZFNjZW5lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUNBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsY0FBYyxFQUFFO0FBQ1osaUJBQVMsSUFERztBQUVaQyxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFG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LENBQUNpRCxXQUFILENBQWVDLFVBQWYsQ0FBMEIsS0FBS3JDLFVBQS9CLEVBQTJDLEtBQTNDO0FBQ0EsU0FBS1EsS0FBTDtBQUNBLFNBQUtWLEtBQUwsQ0FBV3dDLE1BQVgsR0FBa0IsWUFBVSxLQUFLOUIsS0FBakM7QUFDSCxHQXRISTtBQXVITDtBQUNBK0IsRUFBQUEsT0FBTyxFQUFDLGlCQUFTckIsQ0FBVCxFQUFXQyxDQUFYLEVBQWE7QUFDakIsUUFBSXFCLE9BQU8sR0FBR3JELEVBQUUsQ0FBQ2tDLFdBQUgsQ0FBZSxLQUFLbEIsVUFBcEIsQ0FBZDtBQUNBLFNBQUttQixJQUFMLENBQVVDLFFBQVYsQ0FBbUJpQixPQUFuQjtBQUNBQSxJQUFBQSxPQUFPLENBQUNoQixXQUFSLENBQW9CckMsRUFBRSxDQUFDc0MsRUFBSCxDQUFNUCxDQUFOLEVBQVFDLENBQVIsQ0FBcEI7QUFDSCxHQTVISTtBQTZITDtBQUNBc0IsRUFBQUEsT0FBTyxFQUFDLGlCQUFTdkIsQ0FBVCxFQUFXQyxDQUFYLEVBQWE7QUFDakIsUUFBSXVCLE9BQU8sR0FBR3ZELEVBQUUsQ0FBQ2tDLFdBQUgsQ0FBZSxLQUFLaEIsSUFBcEIsQ0FBZDtBQUNBLFNBQUtpQixJQUFMLENBQVVDLFFBQVYsQ0FBbUJtQixPQUFuQjtBQUNBQSxJQUFBQSxPQUFPLENBQUNsQixXQUFSLENBQW9CckMsRUFBRSxDQUFDc0MsRUFBSCxDQUFNUCxDQUFOLEVBQVFDLENBQVIsQ0FBcEI7QUFDSCxHQWxJSTtBQW1JTHdCLEVBQUFBLFdBQVcsRUFBQyxxQkFBU3pCLENBQVQsRUFBVztBQUNuQixTQUFLWCxJQUFMLEdBQVVXLENBQVY7QUFDSCxHQXJJSTtBQXNJTDBCLEVBQUFBLFFBdElLLHNCQXNJSztBQUNOekQsSUFBQUEsRUFBRSxDQUFDMEQsUUFBSCxDQUFZQyxTQUFaLENBQXNCLEtBQXRCO0FBQ0g7QUF4SUksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgYnVsbGV0XzFQcmVmYWI6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwbGF5ZXI6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW5lbXlQcmVmYWI6e1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVuZW15QnVsbGV0UHJlZmFiOntcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzY29yZTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2NvcmVBdWRpbzoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5BdWRpb0NsaXBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJ1bGxldF8yUHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9vbVByZWZhYjp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW5lbXlCdWZmUHJlZmFiOntcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBidWZmOntcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLnRyYW49MDtcclxuICAgICAgICB0aGlzLlNjb3JlPTA7XHJcbiAgICAgICAgdGhpcy5idWxsZXRyRHVyYXRpb249MjtcclxuICAgICAgICB0aGlzLnRpbWVyPTA7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuZ2V0Q29tcG9uZW50KCdwbGF5ZXInKS5nYW1lID0gdGhpcztcclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQgKCkge1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcbiAgICAgICAgLy9lbmVteSBwbGFuZVxyXG4gICAgICAgIGlmICh0aGlzLnRpbWVyID4gdGhpcy5idWxsZXRyRHVyYXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5zcGF3bk5ld0VuZW15KCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXI9MDtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRpbWVyICs9IGR0OyBcclxuICAgIH0sXHJcblxyXG4gICAgLy9idWxsZXRcclxuICAgIHNwYXduTmV3QnVsbGV0OiBmdW5jdGlvbihYLFkpIHtcclxuICAgICAgICBzd2l0Y2godGhpcy50cmFuKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgIHZhciBuZXdCdWxsZXQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJ1bGxldF8xUHJlZmFiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChuZXdCdWxsZXQpO1xyXG4gICAgICAgICAgICAgICAgbmV3QnVsbGV0LnNldFBvc2l0aW9uKGNjLnYyKFgsWSkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIHZhciBuZXdCdWxsZXQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJ1bGxldF8yUHJlZmFiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChuZXdCdWxsZXQpO1xyXG4gICAgICAgICAgICAgICAgbmV3QnVsbGV0LnNldFBvc2l0aW9uKGNjLnYyKFgsWSkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL2VuZW15IHBsYW5lIHJhbmRvbSBsb2NhdGlvblxyXG4gICAgc3Bhd25OZXdFbmVteTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYoTWF0aC5yYW5kb20oKTwwLjMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbmV3RW5lbXkgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmVuZW15QnVmZlByZWZhYik7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChuZXdFbmVteSk7XHJcbiAgICAgICAgICAgIG5ld0VuZW15LnNldFBvc2l0aW9uKHRoaXMuZ2V0TmV3RW5lbXlQb3NpdGlvbigpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdmFyIG5ld0VuZW15ID0gY2MuaW5zdGFudGlhdGUodGhpcy5lbmVteVByZWZhYik7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChuZXdFbmVteSk7XHJcbiAgICAgICAgICAgIG5ld0VuZW15LnNldFBvc2l0aW9uKHRoaXMuZ2V0TmV3RW5lbXlQb3NpdGlvbigpKTtcclxuICAgICAgICB9ICAgXHJcbiAgICB9LFxyXG4gICAgZ2V0TmV3RW5lbXlQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByYW5kWCA9IDA7XHJcbiAgICAgICAgLy8gIGdldCB0aGUgeCBjb29yZGlhdGUgdGhyb3VnaCBzY3JlZW4gd2lkdGhcclxuICAgICAgICB2YXIgbWF4WCA9IHRoaXMubm9kZS53aWR0aC8yO1xyXG4gICAgICAgIHJhbmRYID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMiAqIG1heFg7XHJcbiAgICAgICAgcmV0dXJuIGNjLnYyKHJhbmRYLCA0ODApO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL2VuZW15IHBsYW5lJ3MgYnVsbGV0XHJcbiAgICBzcGF3bkVuZW15QnVsbGV0OiBmdW5jdGlvbihYLFkpIHtcclxuICAgICAgICB2YXIgbmV3RW5lbXlCdWxsZXQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmVuZW15QnVsbGV0UHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobmV3RW5lbXlCdWxsZXQpO1xyXG4gICAgICAgIG5ld0VuZW15QnVsbGV0LnNldFBvc2l0aW9uKGNjLnYyKFgsWSkpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL3Njb3JlXHJcbiAgICBhZGRTY29yZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QodGhpcy5zY29yZUF1ZGlvLCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5TY29yZSsrO1xyXG4gICAgICAgIHRoaXMuc2NvcmUuc3RyaW5nPVwiU2NvZXI6IFwiK3RoaXMuU2NvcmU7XHJcbiAgICB9LFxyXG4gICAgLy9ib29tXHJcbiAgICBhZGRCb29tOmZ1bmN0aW9uKFgsWSl7XHJcbiAgICAgICAgdmFyIG5ld0Jvb20gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJvb21QcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChuZXdCb29tKTtcclxuICAgICAgICBuZXdCb29tLnNldFBvc2l0aW9uKGNjLnYyKFgsWSkpO1xyXG4gICAgfSxcclxuICAgIC8vYnVmZlxyXG4gICAgYWRkQnVmZjpmdW5jdGlvbihYLFkpe1xyXG4gICAgICAgIHZhciBuZXdCdWZmID0gY2MuaW5zdGFudGlhdGUodGhpcy5idWZmKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobmV3QnVmZik7XHJcbiAgICAgICAgbmV3QnVmZi5zZXRQb3NpdGlvbihjYy52MihYLFkpKTtcclxuICAgIH0sXHJcbiAgICB0cmFuX0J1bGxldDpmdW5jdGlvbihYKXtcclxuICAgICAgICB0aGlzLnRyYW49WDtcclxuICAgIH0sXHJcbiAgICBnYW1lT3Zlcigpe1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnZW5kJylcclxuICAgIH1cclxuXHJcbn0pO1xyXG4iXX0=
{"version":3,"sources":["assets\\script\\hero.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\nimport App from \"./app\";\r\nimport Bullet from \"./bullet\";\r\nimport Main from \"./main\";\r\n\r\nconst Input ={};\r\n@ccclass\r\nexport default class Hero extends cc.Component {\r\n    //子弹pfb\r\n    @property(cc.Prefab)\r\n    pfb_bullet1: cc.Prefab = null;\r\n\r\n    //子弹发射声音\r\n    @property(cc.AudioClip)\r\n    audio_bullet: cc.AudioClip = null;\r\n\r\n     //飞机被毁声音\r\n     @property(cc.AudioClip)\r\n     audio_hero_blowup: cc.AudioClip = null;\r\n\r\n    _speed=300;\r\n    //水平速度\r\n    //   private hv = 0;\r\n    //水平加速度\r\n    //   private ahV=0.5;\r\n    onLoad() {\r\n        this._speed=300;\r\n\r\n        // cc.log(\"生成子弹池\");\r\n        App.Instance.AddTypePool(\"Bullet1\", 50, this.pfb_bullet1);\r\n        cc.systemEvent.on('keydown',this.onKeydown,this)\r\n        cc.systemEvent.on('keyup', this.onKeyup, this)\r\n    }\r\n\r\n    start() {\r\n        // this.node.on(cc.Node.EventType.TOUCH_MOVE, this.dragMove, this);\r\n    }\r\n\r\n    onKeydown(e){\r\n        Input[e.keyCode] = 1\r\n    }\r\n\r\n    onKeyup(e){\r\n        Input[e.keyCode] = 0\r\n\r\n    }\r\n    update(dt) {\r\n        //根据要移动的方向更新主角速度\r\n        //左右移动\r\n        if (Input[cc.macro.KEY.a] || Input[cc.macro.KEY.left]) {\r\n           this.node.x-=this._speed*dt;\r\n        } else if (Input[cc.macro.KEY.d] || Input[cc.macro.KEY.right]){\r\n            this.node.x += this._speed * dt;\r\n       }else{\r\n\r\n       }\r\n\r\n        if (Input[cc.macro.KEY.w] || Input[cc.macro.KEY.up]) {\r\n            this.node.y += this._speed * dt;\r\n        } else if (Input[cc.macro.KEY.s] || Input[cc.macro.KEY.down]) {\r\n            this.node.y -= this._speed * dt;\r\n        } else {\r\n\r\n        }\r\n\r\n    }\r\n\r\n    //移动处理\r\n     private dragMove(e): void {\r\n         var locationv = e.getLocation();\r\n         var location = this.node.parent.convertToNodeSpaceAR(locationv);\r\n         //飞机不移出屏幕 \r\n         var minX = -this.node.parent.width / 2 + this.node.width / 2;\r\n         var maxX = -minX;\r\n         var minY = -this.node.parent.height / 2 + this.node.height / 2;\r\n         var maxY = -minY;\r\n         if (location.x < minX) {\r\n             location.x = minX;\r\n         }\r\n         if (location.x > maxX) {\r\n             location.x = maxX;\r\n         }\r\n         if (location.y < minY) {\r\n             location.y = minY;\r\n         }\r\n         if (location.y > maxY) {\r\n             location.y = maxY;\r\n         }\r\n         this.node.setPosition(location);\r\n     }\r\n\r\n    //单发\r\n    sigleFire(type: number) {\r\n        this.genBullet();\r\n    }\r\n    //连发\r\n    autoFire() {\r\n        this.schedule(this.genBullet, 0.1, cc.macro.REPEAT_FOREVER);\r\n    }\r\n    //停止发射\r\n    stopFire() {\r\n        this.unschedule(this.genBullet);\r\n    }\r\n\r\n    changeSpeed1(){\r\n        this._speed = 500;\r\n    }\r\n    changeSpeed2() {\r\n        this._speed = 1000;\r\n    }\r\n    //生成子弹\r\n    genBullet() {\r\n        cc.audioEngine.play(this.audio_bullet,false,1);\r\n        // cc.log(\"生成子弹1\");\r\n        let bullet1 = App.Instance.GetNodeFromPool(\"Bullet1\");\r\n        this.node.parent.addChild(bullet1);\r\n        bullet1.setPosition(cc.v2(this.node.x, this.node.y + 20));\r\n        bullet1.getComponent(Bullet).fly();\r\n        // cc.log(\"bullet1 group=\",bullet1.group);\r\n    }\r\n\r\n    \r\n\r\n    //碰撞检测\r\n    onCollisionEnter(other, self) {\r\n        this.stopFire();\r\n        //停止碰撞检测\r\n        this.node.group=\"default\";\r\n        this.node.targetOff(this);\r\n\r\n        cc.log(\"碰撞到检测\");\r\n        cc.audioEngine.play(this.audio_hero_blowup,false,1);\r\n        var anim = this.node.getComponent(cc.Animation);\r\n        // 指定播放 test 动画\r\n        anim.play('hero_blowup');\r\n        anim.on('finished', ()=>{\r\n            this.node.destroy();\r\n            this.node.parent.getComponent(Main).gameOver();\r\n        }, this);\r\n\r\n        \r\n    }\r\n\r\n}\r\n"]}
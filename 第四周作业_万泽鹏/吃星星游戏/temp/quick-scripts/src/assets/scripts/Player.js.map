{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["cc","Class","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","type","AudioClip","onLoad","jumpAction","setJumpAction","accLeft","accRight","xSpeed","currentHeight","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","playJumpSound","sequence","audioEngine","playEffect","event","keyCode","macro","KEY","a","d","logNumber","console","log","w","Math","round","node","runAction","update","dt","abs","y","x","width","onDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n         // 主角跳跃高度\r\n         jumpHeight: 0,\r\n         // 主角跳跃持续时间\r\n         jumpDuration: 0,\r\n         // 最大移动速度\r\n         maxMoveSpeed: 0,\r\n         // 加速度\r\n         accel: 0,\r\n         jumpAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n    onLoad: function () {\r\n        // 初始化跳跃动作\r\n        this.jumpAction = this.setJumpAction();\r\n        // this.node.runAction(this.jumpAction);\r\n         // 加速度方向开关\r\n         this.accLeft = false;\r\n         this.accRight = false;\r\n         // 主角当前水平方向速度\r\n         this.xSpeed = 0;\r\n        this.currentHeight = 0;\r\n         // 初始化键盘输入监听\r\n         cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n         cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);  \r\n    },\r\n    setJumpAction: function () {\r\n        // 跳跃上升\r\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        // 下落\r\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        // 添加一个回调函数，用于在动作结束时调用我们定义的其他方法\r\n        var callback = cc.callFunc(this.playJumpSound, this);\r\n        // 不断重复\r\n        // return cc.repeatForever(cc.sequence(jumpUp, jumpDown));\r\n        return cc.sequence(callback,jumpUp, jumpDown);\r\n    },\r\n    playJumpSound: function () {\r\n        // 调用声音引擎播放声音\r\n        cc.audioEngine.playEffect(this.jumpAudio, false);\r\n    },\r\n    onKeyDown (event) {\r\n        // set a flag when key pressed\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = true;\r\n                break;\r\n        }\r\n    },\r\n    logNumber:function(){\r\n        console.log(1)\r\n    },\r\n    onKeyUp (event) {\r\n        // a键向左加速，w键跳跃，d向右加速\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = false;\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                if(Math.round(this.currentHeight) == -120)\r\n                {this.node.runAction(this.jumpAction);}\r\n                break;\r\n        }\r\n    },\r\n    update: function (dt) {\r\n        // 根据当前加速度方向每帧更新速度\r\n        if (this.accLeft) {\r\n            this.xSpeed -= this.accel * dt;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        // 限制主角的速度不能超过最大值\r\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n        this.currentHeight = this.node.y;\r\n        if(this.node.x <= -480+this.node.width/2||this.node.x >=480-this.node.width/2){\r\n            this.xSpeed = -this.xSpeed\r\n        }\r\n        // 根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed * dt;\r\n    },\r\n    onDestroy () {\r\n        // 取消键盘输入监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n\r\n});\r\n"]}
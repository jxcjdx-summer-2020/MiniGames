{"version":3,"sources":["assets\\Script\\bullet.js"],"names":["cc","Class","Component","properties","ySpeed","tooltip","type","Integer","harm","easeOut","pierce","onLoad","manager","director","getCollisionManager","enabled","init","node","componentName","object_pool","find","getComponent","setCurrentPosition","x","y","height","fire","currentNode","parent","action","moveTo","easing","finished","callFunc","recyclePool","name","myAction","sequence","show","runAction","$base","audio","play","onCollisionEnter","other","self","stopAllActions"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n// 由于子弹开始设定没有考虑到多种子弹属性，后续维护使用两种区分\r\n// 保留原逻辑为默认子弹，新建子弹工厂为道具包子弹\r\n// 道具包子弹拥有以下可随时定义属性\r\n// 1.子弹速度\r\n// 2.子弹伤害\r\n// 3.子弹射速\r\n// 4.子弹资源（由当前节点而定）\r\n// 5.子弹音效 (音效由全局播放器资源添加，这边只做抛给播放器要使用什么音效)\r\n// 6.子弹数量 (数量由道具包定义)\r\n// 7.子弹速率\r\n// 8.子弹血量 (决定当前子弹是否具有穿透)\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ySpeed: {\r\n            default: 3,\r\n            tooltip: '子弹速度',\r\n            type: cc.Integer\r\n        },\r\n        harm: {\r\n            default: 1,\r\n            tooltip: '伤害'\r\n        },\r\n        easeOut: {\r\n            default: 1.6,\r\n            tooltip: '子弹由快到慢'\r\n        },\r\n        pierce: {\r\n            default: false,\r\n            tooltip: '子弹是否有穿透'\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true\r\n        this.init()\r\n    },\r\n\r\n    init() {\r\n        this.node.componentName = 'bullet'\r\n        this.object_pool = cc.find('Canvas/object_pool').getComponent('object_pool') // 最初考虑对象池为按需引入 后面发现对象池使用地方太多因改全局对象\r\n    },\r\n    // start () {\r\n    // },\r\n\r\n    // update (dt) {\r\n\r\n    // },\r\n\r\n    setCurrentPosition(node) {\r\n        // console.log(this.node.parent, 'setCurrentPosition');\r\n        this.node.x = node.x\r\n        this.node.y = node.y + (node.height / 2) + (this.node.height / 2)\r\n        return this\r\n    },\r\n\r\n    fire(currentNode) { \r\n        const parent = cc.find('Canvas/background')\r\n        const object_pool = this.object_pool\r\n        var action = cc.moveTo(this.ySpeed, currentNode.x, (parent.height/2) + (this.node.height * 0.5));\r\n        action.easing(cc.easeOut(this.easeOut))\r\n        var finished = cc.callFunc(function () {\r\n            object_pool.recyclePool({\r\n                node: this.node,\r\n                name: this.node.name\r\n            })\r\n        }, this);\r\n        var myAction = cc.sequence(cc.show(),action, finished);\r\n        this.node.runAction(myAction);\r\n        $base.audio.play('bullet')\r\n    },\r\n    onCollisionEnter: function (other, self) {\r\n        this.node.stopAllActions()\r\n        this.object_pool.recyclePool({\r\n            node: this.node,\r\n            name: this.node.name\r\n        })\r\n    }\r\n});\r\n"]}
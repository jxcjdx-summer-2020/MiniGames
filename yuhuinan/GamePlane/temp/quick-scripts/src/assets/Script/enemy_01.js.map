{"version":3,"sources":["assets\\Script\\enemy_01.js"],"names":["cc","Class","Component","properties","initHp","HP","ySpeed","tooltip","hitAnimation","node","anim","getComponent","Animation","name","hide","animName","audioName","stopAllActions","$base","count","grade","on","off","object_pool","find","runAction","getInitHp","setCurrentTime","recyclePool","isHit","play","audio","hit","ruin","Number","init","componentName","onLoad","manager","director","getCollisionManager","enabled","onCollisionEnter","other","component","harm","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        initHp: {\r\n            default: 1\r\n        },\r\n        HP: {\r\n            default: 1\r\n        },\r\n        ySpeed: {\r\n            default: 3,\r\n            tooltip: '移动到底部需要多少时间'\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    hitAnimation() { // 击中执行动画\r\n        let node = this.node\r\n        let anim = this.getComponent(cc.Animation);\r\n        let name = node.name\r\n        node.hide = false\r\n        if(this.HP === 0) {\r\n            let animName = `${name}_ruin`\r\n            let audioName = `${name}_down`\r\n            node.stopAllActions()\r\n            $base.count(this.node.grade)\r\n            anim.on('finished',()=>{\r\n                \r\n                // console.log('结束');\r\n                anim.off('finished')\r\n                const object_pool = cc.find('Canvas/object_pool').getComponent('object_pool')\r\n                node.hide = true\r\n                anim.node.runAction(cc.hide())\r\n                this.HP = this.getInitHp()\r\n                // console.log(this, 'this.getInitHp()');\r\n                anim.setCurrentTime(0,animName)\r\n                node.ySpeed = this.ySpeed\r\n                object_pool.recyclePool({ name,node })\r\n                this.isHit = false\r\n            },anim);\r\n            anim.play(animName)\r\n            $base.audio.play(audioName)\r\n        } else {\r\n            \r\n            let animName = `${name}_hit`\r\n            // console.log(animName,this, this.HP, '未灭亡');\r\n            anim.on('finished',()=>{\r\n                // console.log('结束');\r\n                anim.off('finished')\r\n                anim.setCurrentTime(0,animName)\r\n                this.isHit = false\r\n            },anim);\r\n            anim.play(animName)\r\n        }\r\n    },\r\n\r\n    hit(ruin) {\r\n        this.HP -= ruin\r\n        if(this.HP  < 0 ) this.HP = 0\r\n        this.hitAnimation()\r\n        return this.HP\r\n    },\r\n\r\n    getInitHp() {\r\n        return  new Number( this.initHp )\r\n    },\r\n\r\n    init() {\r\n        this.node.componentName = 'enemy_01'        \r\n        this.node.ySpeed = this.ySpeed\r\n    },\r\n\r\n    onLoad () {\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true\r\n        this.init()\r\n    },\r\n\r\n    onCollisionEnter: function (other) { // 碰撞开始\r\n        if(this.isHit) return\r\n        this.isHit = true\r\n        let component = other.getComponent(other.node.componentName)\r\n        let harm = component.harm\r\n        this.hit(harm, other)\r\n        // console.log(component, other);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}
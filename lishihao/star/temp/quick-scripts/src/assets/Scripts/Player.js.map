{"version":3,"sources":["assets\\Scripts\\Player.js"],"names":["cc","Class","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","Mcanvas","type","Node","jumpAudio","AudioClip","setJumpAction","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","playJumpSound","repeatForever","sequence","onKeyDown","event","keyCode","macro","KEY","a","accLeft","d","accRight","onKeyUp","audioEngine","playEffect","onLoad","jumpAction","node","runAction","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","start","update","dt","Math","abs","x"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //主角跳跃高度\r\n        jumpHeight:0,\r\n        //主角跳跃持续时间\r\n        jumpDuration:0,\r\n        //最大移动速度\r\n        maxMoveSpeed:0,\r\n        //加速度\r\n        accel:0,\r\n        Mcanvas:{\r\n            default: null,\r\n            type:cc.Node\r\n        },\r\n        // 跳跃音效资源\r\n        jumpAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n\r\n    setJumpAction: function()\r\n    {\r\n        //跳跃动作\r\n        var jumpUp = cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        var jumpDown = cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        // 添加一个回调函数，用于在动作结束时调用我们定义的其他方法\r\n        var callback = cc.callFunc(this.playJumpSound, this);\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown,callback));\r\n    },\r\n\r\n    //移动控制\r\n    onKeyDown(event){\r\n        switch(event.keyCode){\r\n            case(cc.macro.KEY.a):\r\n                this.accLeft = true;\r\n                break;\r\n            case(cc.macro.KEY.d):\r\n                this.accRight = true;\r\n                break;\r\n        }\r\n    },\r\n    onKeyUp(event){\r\n        switch(event.keyCode){\r\n            case(cc.macro.KEY.a):\r\n                this.accLeft = false;\r\n                break;\r\n            case(cc.macro.KEY.d):\r\n                this.accRight = false;\r\n                break;\r\n        }\r\n    },\r\n\r\n    playJumpSound: function () {\r\n        // 调用声音引擎播放声音\r\n        cc.audioEngine.playEffect(this.jumpAudio, false);\r\n    },\r\n\r\n    onLoad: function () {\r\n        // 初始化跳跃动作\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n        //加速度方向开关\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n        //水平速度\r\n        this.xSpeed = 0;\r\n        //初始化键盘事件监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n    onDestroy () {\r\n        //取消监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType,KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType,KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    start: function () {\r\n\r\n    },\r\n\r\n    update: function(dt){\r\n        if(this.accLeft){\r\n            this.xSpeed -=this.accel *dt;\r\n        }else if(this.accRight){\r\n            this.xSpeed +=this.accel *dt;\r\n        }\r\n        //限制主角不能超过maxMoveSpeed\r\n        if(Math.abs(this.xSpeed)>this.maxMoveSpeed){\r\n            this.xSpeed =this.maxMoveSpeed *this.xSpeed/Math.abs(this.xSpeed);\r\n        }\r\n        //根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed *dt;\r\n        //撞墙反弹\r\n        if (this.node.x>=this.Mcanvas.x || this.node.x<=-this.Mcanvas.x){\r\n            this.xSpeed = -this.xSpeed;\r\n        }\r\n    },\r\n});\r\n"]}